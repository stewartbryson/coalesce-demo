steps:
  STG_NATION_REGION_SUPPLIER-214:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: STAGE
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 3683
              stepCounter: "214"
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: PSTG_NATION_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3648
                    stepCounter: "211"
                transform: ""
          - columnReference:
              columnCounter: 3684
              stepCounter: "214"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: N_NATIONKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3649
                    stepCounter: "211"
                transform: ""
          - columnReference:
              columnCounter: 3685
              stepCounter: "214"
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: N_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3650
                    stepCounter: "211"
                transform: INITCAP("PSTG_NATION"."N_NAME")
          - columnReference:
              columnCounter: 3686
              stepCounter: "214"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: N_REGIONKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3651
                    stepCounter: "211"
                transform: ""
          - columnReference:
              columnCounter: 3687
              stepCounter: "214"
            dataType: VARCHAR(152)
            description: ""
            hashColumns: []
            hashDetails: null
            name: N_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3652
                    stepCounter: "211"
                transform: ""
          - columnReference:
              columnCounter: 3694
              stepCounter: "214"
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: PSTG_REGION_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3659
                    stepCounter: "212"
                transform: ""
          - columnReference:
              columnCounter: 3695
              stepCounter: "214"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: R_REGIONKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3660
                    stepCounter: "212"
                transform: ""
          - columnReference:
              columnCounter: 3696
              stepCounter: "214"
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: R_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3661
                    stepCounter: "212"
                transform: INITCAP("PSTG_REGION"."R_NAME")
          - columnReference:
              columnCounter: 3697
              stepCounter: "214"
            dataType: VARCHAR(152)
            description: ""
            hashColumns: []
            hashDetails: null
            name: R_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3662
                    stepCounter: "212"
                transform: ""
          - columnReference:
              columnCounter: 3704
              stepCounter: "214"
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: PSTG_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3669
                    stepCounter: "213"
                transform: ""
          - columnReference:
              columnCounter: 3705
              stepCounter: "214"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: S_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3670
                    stepCounter: "213"
                transform: ""
          - columnReference:
              columnCounter: 3706
              stepCounter: "214"
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: S_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3671
                    stepCounter: "213"
                transform: ""
          - columnReference:
              columnCounter: 3707
              stepCounter: "214"
            dataType: VARCHAR(40)
            description: ""
            hashColumns: []
            hashDetails: null
            name: S_ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3672
                    stepCounter: "213"
                transform: ""
          - columnReference:
              columnCounter: 3708
              stepCounter: "214"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: S_NATIONKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3673
                    stepCounter: "213"
                transform: ""
          - columnReference:
              columnCounter: 3709
              stepCounter: "214"
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: S_PHONE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3674
                    stepCounter: "213"
                transform: ""
          - columnReference:
              columnCounter: 3710
              stepCounter: "214"
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: S_ACCTBAL
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3675
                    stepCounter: "213"
                transform: ""
          - columnReference:
              columnCounter: 3718
              stepCounter: "214"
            dataType: VARCHAR
            description: ""
            hashColumns: []
            hashDetails: null
            name: SUPPLIER_RATING
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3675
                    stepCounter: "213"
                transform: |-
                  CASE
                  WHEN "PSTG_SUPPLIER"."S_ACCTBAL" > 0 then 'Good'
                  else 'Bad'
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              PSTG_NATION: "211"
              PSTG_REGION: "212"
              PSTG_SUPPLIER: "213"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: STAGE
                nodeName: PSTG_NATION
              - locationName: STAGE
                nodeName: PSTG_REGION
              - locationName: STAGE
                nodeName: PSTG_SUPPLIER
            join:
              joinCondition: |-
                FROM {{ ref('STAGE', 'PSTG_NATION') }} "PSTG_NATION"
                LEFT JOIN {{ ref('STAGE', 'PSTG_REGION') }} "PSTG_REGION"
                ON "PSTG_NATION"."N_REGIONKEY" = "PSTG_REGION"."R_REGIONKEY"
                LEFT JOIN {{ ref('STAGE', 'PSTG_SUPPLIER') }} "PSTG_SUPPLIER"
                ON "PSTG_NATION"."N_NATIONKEY" = "PSTG_SUPPLIER"."S_NATIONKEY"
            name: STG_NATION_REGION_SUPPLIER
            noLinkRefs: []
      name: STG_NATION_REGION_SUPPLIER
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: "214"
